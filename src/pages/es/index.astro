---
import { Icon } from 'astro-icon/components';
import Layout from '@layouts/Layout.astro';
---

<Layout
  title="Infraestructuras para la alimentación sostenible"
  description="Un estudio sobre el modelo público-comunitario del Matadero de l'Armentera y de la producción porcina ecológica, elaborado por la IDRA 2025"
  includeFooter={false}
  includeHeader={false}
>
  <main class="container mx-auto px-4 md:px-8">
    <div
      class="grid gap-8 grid-rows-[3rem_30vh_1fr] md:grid-rows-[3rem_45vh_1fr] md:h-dvh"
    >
      <nav
        id="lang-menu"
        class="uppercase text-xs py-4"
        aria-label="Language selector"
      >
        <a href="/" class="mr-4" aria-label="català">ca</a>
        <a href="/es/" aria-label="castellano">es</a>
      </nav>

      <div class="self-end mb-2 md:mb-12 m-a-from-bottom-1">
        <h1
          class="text-5xl font-bold mb-6 md:text-10xl lg:text-13xl 2xl:text-17xl"
        >
          Infraestructuras para la alimentación sostenible
        </h1>
        <p class="max-w-2xl 2xl:text-xl">
          Un estudio sobre el modelo público-comunitario del Matadero de
          l'Armentera y de la producción porcina ecológica, elaborado por la <a
            href="https://idrabcn.com/es"
            class="border-b border-b-black border-solid pb-1">IDRA</a
          >
          (2025).
        </p>
      </div>

      <div class="grid gap-8 md:grid-cols-3 m-a-from-bottom-2">
        <a
          href="/es/cronologia/"
          class="bg-rose-100 p-4"
          aria-label="Cronologia: Els escorxadors municipals. Breu història d'una infraestructura clau."
        >
          <div
            class="h-full flex flex-col justify-between border-l border-l-black pl-4"
          >
            <div>
              <h2 class="font-bold mb-4 md:text-2xl">Cronología</h2>
              <p class="text-sm">
                Breve historia de los mataderos municipales.
              </p>
            </div>

            <Icon
              name="arrow-right"
              class="text-xs text-black mt-6 md:mt-0"
              aria-hidden="true"
            />
          </div>
        </a>
        <a
          href="/es/comparativa/"
          class="bg-amber-100 p-4"
          aria-label="Comparativa: Implicacions econòmiques i ecològiques de dos models oposats"
        >
          <div
            class="h-full flex flex-col justify-between border-l border-l-black pl-4"
          >
            <div>
              <h2 class="font-bold mb-4 md:text-2xl">Comparativa</h2>
              <p class="text-sm">
                Cerdo industrial - Cerdo ecológico. Dos modelos opuestos.
              </p>
            </div>
            <Icon
              name="arrow-right"
              class="text-xs text-black mt-6 md:mt-0"
              aria-hidden="true"
            />
          </div>
        </a>
        <a
          href="/es/matadero-armentera/"
          class="bg-sky-100 p-4"
          aria-label="L'escorxador de l'Armentera: Un model de col·laboració público-comunitaria"
        >
          <div
            class="h-full flex flex-col justify-between border-l border-l-black pl-4"
          >
            <div>
              <h2 class="font-bold mb-4 md:text-2xl">
                El matadero de l'Armentera.
              </h2>
              <p class="text-sm">
                Circuitos cortos de comercialización alimentaria y diagrama de
                flujos.
              </p>
            </div>
            <Icon
              name="arrow-right"
              class="text-xs text-black mt-6 md:mt-0"
              aria-hidden="true"
            />
          </div>
        </a>
      </div>
    </div>
  </main>
</Layout>

<script>
  import { gsap, fadeIn, ScrollTrigger } from '@lib/gsap';

  function initHomepage() {
    const heroSections = document.querySelectorAll('.container');

    heroSections.forEach(section => {
      const element1 = section.querySelector('.m-a-from-bottom-1');
      const element2 = section.querySelector('.m-a-from-bottom-2');

      const tlHero = gsap.timeline({
        scrollTrigger: {
          trigger: section,
          toggleActions: 'play none none reverse',
          start: 'top 30%',
        },
      });

      tlHero.add(fadeIn(element1)).add(fadeIn(element2));
    });
  }

  document.addEventListener('astro:page-load', initHomepage);

  document.addEventListener('astro:before-preparation', () => {
    ScrollTrigger.getAll().forEach(trigger => trigger.kill());
  });
</script>
