---
import {
  getLangFromUrl,
  useTranslations,
  useTranslatedPath,
} from '@i18n/utils';
const lang = getLangFromUrl(Astro.url);
const translateString = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

const currentPath = Astro.url.pathname;
const isCurrentPage = (path: string) => {
  const translatedPath = translatePath(path);
  if (path === '/') {
    return currentPath === translatedPath;
  }
  return (
    currentPath === translatedPath || currentPath.startsWith(translatedPath)
  );
};
---

<nav
  aria-label={translateString('mainNavigation') || 'Main navigation'}
  class="fixed lg:static top-0 left-0 right-0 h-4/6 lg:h-auto lg:w-auto bg-yellow-400 lg:bg-transparent z-10 lg:z-auto"
>
  <div class="grid lg:static place-items-center h-full lg:h-auto">
    <ul
      class="flex gap-x-6 flex-col text-4xl mx-8 lg:flex-row md:mx-0 lg:text-xs 2xl:text-sm"
    >
      <li>
        <a
          href={translatePath('/')}
          aria-current={isCurrentPage('/') ? 'page' : undefined}
        >
          {translateString('navHome')}
        </a>
      </li>
      <li>
        <a
          href={translatePath('timeline')}
          aria-current={isCurrentPage('timeline') ? 'page' : undefined}
        >
          {translateString('navTimeline')}
        </a>
      </li>
      <li>
        <a
          href={translatePath('comparative')}
          aria-current={isCurrentPage('comparative') ? 'page' : undefined}
        >
          {translateString('navComparative')}
        </a>
      </li>
      <li>
        <a
          href={translatePath('escorxadorArmentera')}
          aria-current={isCurrentPage('escorxadorArmentera')
            ? 'page'
            : undefined}
        >
          {translateString('navMaps')}
        </a>
      </li>
    </ul>
  </div>
</nav>

<style>
  a[aria-current='page'] {
    border-bottom: 1px solid currentColor;
    padding-bottom: 0.15rem;
  }
</style>
